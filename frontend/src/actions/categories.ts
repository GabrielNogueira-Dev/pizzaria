"use server"

import { apiClient } from "@/lib/api"
import { getToken } from "@/lib/auth"
import { Category } from "@/lib/types"

import { revalidatePath } from "next/cache"

export async function createCategoryAction(formData: FormData) {
    
    try{
         const token = await getToken()
         const name  = formData.get("name")

        const data = {
            name: name
        }

            await apiClient<Category>("/category",{
                method:"POST",
                body:JSON.stringify(data),
                token:token
            })

            revalidatePath("/dashboard/categories") //revalida o F5 da pagina ao atualizar o cadastro de categoria
                return {success:true, error:""}

    }catch(error){

        if(error instanceof Error){
            return {success:false, error: error.message}
        }
 return {success:false,error:"Error ao criar categoria"}
    }
   
}